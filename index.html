<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>moviehd99 Movie 2025 Hollywood, Bollywood, Bangla</title>
    <meta name="title" content="moviehd99 - Latest Hollywood, Bollywood & Bangla Movies">
    <meta name="description" content="Watch and download the latest Hollywood, Bollywood, and Bangla movies daily. Get updates on new releases and full movie details.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #121212;
            color: #f5f5f5;
        }

        header {
            background-color: #e50914;
            padding: 1rem;
            text-align: center;
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
        }

        h1 {
            margin: 0;
            font-size: 2rem;
            color: #fff;
        }

        nav {
            background: #1f1f1f;
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            padding: 1rem 0;
            border-radius: 8px;
            margin: 1rem;
            flex-wrap: wrap;
        }

        nav a {
            color: #fff;
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        nav a:hover {
            background-color: #e50914;
            color: #fff;
        }

        .container {
            padding: 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            justify-content: center;
        }

        .movie {
            background: #1f1f1f;
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .movie:hover {
            transform: translateY(-5px);
        }

        .movie img {
            width: 100%;
            max-width: 250px;
            height: 375px;
            border-radius: 8px;
            margin-bottom: 1rem;
            object-fit: cover;
        }

        .movie h2 {
            margin: 0.5rem 0;
            font-size: 1.3rem;
            color: #e50914;
            min-height: 3.9rem;
            flex-grow: 1;
        }

        .movie .button-wrapper {
            margin-top: auto;
        }

        .download-btn {
            margin-top: 1rem;
            display: inline-block;
            background: #e50914;
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            text-decoration: none;
            font-weight: bold;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .download-btn:hover {
            background: #ff222d;
            transform: translateY(-2px);
        }

        .view-details-btn {
            margin-top: 0.8rem;
            background: transparent;
            border: 2px solid #e50914;
            color: #e50914;
            padding: 0.6rem 1.2rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.95rem;
            transition: background 0.3s ease, color 0.3s ease;
            display: block;
            width: calc(100% - 2.4rem);
            margin-left: auto;
            margin-right: auto;
        }

        .view-details-btn:hover {
            background: #e50914;
            color: white;
        }

        .pagination {
            text-align: center;
            margin: 2rem 0;
            grid-column: 1 / -1;
        }

        .pagination button {
            background: #e50914;
            color: white;
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 6px;
            font-size: 1.1rem;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .pagination button:hover {
            background: #ff222d;
            transform: translateY(-2px);
        }

        .movie-detail-view {
            background: #1f1f1f;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem auto;
            max-width: 800px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            text-align: left;
        }

        .movie-detail-view img {
            display: block;
            margin: 0 auto 1.5rem auto;
            max-width: 350px;
            border-radius: 10px;
        }

        .movie-detail-view h2 {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #e50914;
        }

        .movie-detail-view p {
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .movie-detail-view .download-btn {
            display: block;
            text-align: center;
            margin: 1.5rem auto 1rem auto;
            max-width: 200px;
        }

        .movie-detail-view .view-details-btn {
            display: block;
            margin: 1rem auto 0 auto;
            max-width: 200px;
            text-align: center;
        }

        .video-container {
            position: relative;
            width: 100%;
            overflow: hidden;
            padding-top: 56.25%; /* 16:9 Aspect Ratio */
            margin-bottom: 1.5rem;
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
            border-radius: 8px;
        }

        /* --- CSS FOR THE CUSTOM FULLSCREEN BUTTON --- */
        .custom-fullscreen-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            border: none;
            border-radius: 5px;
            padding: 8px;
            cursor: pointer;
            z-index: 2147483647; /* Ensures it's on top of the iframe */
            display: block;
        }

        .custom-fullscreen-btn svg {
            width: 20px;
            height: 20px;
            fill: #fff;
            display: block;
        }

        .custom-fullscreen-btn:hover {
            background-color: #e50914;
        }
        
        @media (max-width: 768px) {
            .container {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                padding: 1rem;
            }

            .movie {
                padding: 1rem;
            }

            .movie img {
                height: 300px;
            }

            .movie h2 {
                font-size: 1.1rem;
                min-height: 3.3rem;
            }

            nav {
                gap: 0.5rem;
                margin: 0.5rem;
                padding: 0.8rem;
            }

            .movie-detail-view {
                padding: 1.5rem;
                margin: 1rem;
            }

            .movie-detail-view img {
                max-width: 80%;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>🎬 Daily Movie Updates</h1>
    </header>

    <nav>
        <a id="nav-all">All</a>
        <a id="nav-hollywood">Hollywood</a>
        <a id="nav-bollywood">Bollywood</a>
        <a id="nav-bangla">Bangla</a>
    </nav>

    <div class="container" id="movie-container"></div>

    <div class="pagination">
        <button id="next-btn">Next</button>
    </div>

    <script src="movies.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let currentIndex = 0;
            const limit = 6;
            let filteredMovies = [];
            const container = document.getElementById("movie-container");
            const nextBtn = document.getElementById("next-btn");
            const gitHubPagesBasePath = "/MovieHD99"; // Your repository name
            const isCanvasPreview = window.location.protocol === 'blob:';

            // Function to generate URL-friendly slugs
            function generateSlug(title) {
                return title.toLowerCase()
                    .replace(/[^\w\s-]/g, '') 
                    .replace(/[\s_-]+/g, '-') 
                    .replace(/^-+|-+$/g, '');
            }

            // Function to display movies
            function displayMovies() {
                const nextBatch = filteredMovies.slice(currentIndex, currentIndex + limit);
                nextBatch.forEach((movie) => {
                    const div = document.createElement("div");
                    div.className = "movie";
                    div.innerHTML = `
                        <img src="${movie.img}" alt="${movie.title}" onerror="this.onerror=null;this.src='https://placehold.co/250x375/333333/FFFFFF?text=Image+Not+Found';" />
                        <h2>${movie.title}</h2>
                        <div class="button-wrapper">
                            <button class="view-details-btn" data-title="${encodeURIComponent(movie.title)}">View Details</button>
                        </div>
                    `;
                    container.appendChild(div);
                });

                container.querySelectorAll('.view-details-btn').forEach(btn => {
                    btn.addEventListener('click', (event) => {
                        const title = decodeURIComponent(event.target.getAttribute('data-title'));
                        const movie = movies.find(m => m.title === title);
                        if (movie) {
                            const urlSlug = generateSlug(movie.title);
                            const newPath = gitHubPagesBasePath + "/" + urlSlug;
                            if (!isCanvasPreview) {
                                history.pushState({ movieTitle: movie.title }, movie.title, newPath);
                            }
                            showMovieDetails(movie.title);
                        }
                    });
                });

                currentIndex += limit;
                nextBtn.style.display = currentIndex >= filteredMovies.length ? "none" : "inline-block";
            }

            // Function to set up navigation
            function updateNavLinks() {
                const navLinks = [
                    { id: 'nav-all', category: 'All' },
                    { id: 'nav-hollywood', category: 'Hollywood' },
                    { id: 'nav-bollywood', category: 'Bollywood' },
                    { id: 'nav-bangla', category: 'Bangla' }
                ];
                navLinks.forEach(link => {
                    document.getElementById(link.id).addEventListener('click', (e) => {
                        e.preventDefault();
                        const newPath = gitHubPagesBasePath + "/";
                        if (!isCanvasPreview) {
                            history.pushState({ filterCategory: link.category }, `${link.category} Movies`, newPath);
                        }
                        filterMovies(link.category);
                    });
                });
            }

            // Function to filter movies
            function filterMovies(category) {
                container.innerHTML = '';
                currentIndex = 0;
                document.title = `Daily Movie Updates - ${category}`;
                if (typeof movies === 'undefined' || !movies) {
                    console.error("movies.js data not loaded!");
                    container.innerHTML = "<p>Error: Movie data could not be loaded.</p>";
                    nextBtn.style.display = 'none';
                    return;
                }
                filteredMovies = category === "All" ? [...movies] : movies.filter(movie => movie.category.includes(category));
                displayMovies();
                nextBtn.style.display = currentIndex < filteredMovies.length ? "inline-block" : "none";
            }

            // Function to show movie details - NEW VERSION
            function showMovieDetails(title) {
                container.innerHTML = '';
                nextBtn.style.display = 'none';

                if (typeof movies === 'undefined' || !movies) {
                    showMovieNotFoundError();
                    return;
                }

                const movie = movies.find(m => m.title === title);
                if (!movie) {
                    showMovieNotFoundError();
                    return;
                }

                document.title = `${movie.title} - Details`;
                const detailViewDiv = document.createElement("div");
                detailViewDiv.className = "movie-detail-view";

                let movieDetailHtml = `
                    <img src="${movie.img}" alt="${movie.title}" onerror="this.onerror=null;this.src='https://placehold.co/350x500/333333/FFFFFF?text=Image+Not+Found';" />
                    <h2>${movie.title}</h2>
                    <p><strong>Release Date:</strong> ${movie.year}</p>
                    <p>${movie.desc}</p>
                `;

                // Video Player Section with Custom Fullscreen Button
                if (movie.videoUrl && movie.videoUrl !== '#') {
                    movieDetailHtml += `
                        <div class="video-container">
                            <iframe 
                                src="${movie.videoUrl}" 
                                frameborder="0" 
                                webkitallowfullscreen
                                mozallowfullscreen
                                allowfullscreen
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen">
                            </iframe>
                            <button class="custom-fullscreen-btn" aria-label="Enter Fullscreen">
                                <svg viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>
                            </button>
                        </div>
                    `;
                }

                movieDetailHtml += `<a href="${movie.download}" class="download-btn" download>⬇️ Download</a>`;
                detailViewDiv.innerHTML = movieDetailHtml;

                // --- Fullscreen Logic ---
                const fullscreenBtn = detailViewDiv.querySelector('.custom-fullscreen-btn');
                const videoContainer = detailViewDiv.querySelector('.video-container');

                if (fullscreenBtn && videoContainer) {
                    fullscreenBtn.addEventListener('click', () => {
                        if (videoContainer.requestFullscreen) {
                            videoContainer.requestFullscreen();
                        } else if (videoContainer.webkitRequestFullscreen) { /* Safari */
                            videoContainer.webkitRequestFullscreen();
                        } else if (videoContainer.msRequestFullscreen) { /* IE11 */
                            videoContainer.msRequestFullscreen();
                        }
                    });
                }

                // --- Back Button ---
                const backBtn = document.createElement("button");
                backBtn.textContent = "Back to Movie List";
                backBtn.className = "view-details-btn";
                backBtn.addEventListener("click", () => {
                    const newPath = gitHubPagesBasePath + "/";
                    if (!isCanvasPreview) {
                        history.pushState({ filterCategory: 'All' }, "Movie List", newPath);
                    }
                    filterMovies('All');
                });
                
                detailViewDiv.appendChild(backBtn);
                container.appendChild(detailViewDiv);
            }

            // Function for 'Movie Not Found'
            function showMovieNotFoundError() {
                container.innerHTML = `
                    <div class="movie-detail-view" style="text-align: center; grid-column: 1 / -1;">
                        <p style="font-size: 1.2rem; margin-bottom: 1.5rem;">Movie not found or invalid URL.</p>
                        <button id="backFromNotFound" class="view-details-btn">Back to Movie List</button>
                    </div>
                `;
                document.title = "Movie Not Found";
                document.getElementById("backFromNotFound").addEventListener("click", () => {
                    const newPath = gitHubPagesBasePath + "/";
                    history.pushState({ filterCategory: 'All' }, "Movie List", newPath);
                    filterMovies('All');
                });
            }

            // Handle browser navigation
            window.addEventListener("popstate", (event) => {
                if (event.state?.movieTitle) {
                    showMovieDetails(event.state.movieTitle);
                } else if (event.state?.filterCategory) {
                    filterMovies(event.state.filterCategory);
                } else {
                    handleRouteChange();
                }
            });

            // Handle routing on page load
            function handleRouteChange() {
                const currentPath = window.location.pathname;
                let slug = currentPath.startsWith(gitHubPagesBasePath) ? currentPath.substring(gitHubPagesBasePath.length) : currentPath;
                if (slug.startsWith('/')) slug = slug.substring(1);

                if (slug && slug !== '') {
                    const movie = movies.find(m => generateSlug(m.title) === slug);
                    if (movie) {
                        showMovieDetails(movie.title);
                    } else {
                        showMovieNotFoundError();
                    }
                } else {
                    filterMovies('All');
                }
            }

            // Initialization function
            function init() {
                updateNavLinks();
                handleRouteChange(); 
                nextBtn.addEventListener("click", displayMovies);
            }

            // Ensure movies.js is loaded before initializing
            if (typeof movies !== 'undefined' && movies.length > 0) {
                init();
            } else {
                console.error("movies.js not loaded or empty. Retrying in 0.5s...");
                setTimeout(() => {
                    if (typeof movies !== 'undefined' && movies.length > 0) {
                        init();
                    } else {
                        container.innerHTML = "<h2 style='text-align: center; grid-column: 1 / -1;'>Error: Could not load movie data. Please check `movies.js` and reload.</h2>";
                        nextBtn.style.display = 'none';
                    }
                }, 500);
            }
        });
    </script>
</body>
</html>
