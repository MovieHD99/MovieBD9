<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>moviehd99 Movie 2025 Hollywood, Bollywood, Bangla</title>
    <meta name="title" content="moviehd99 - Latest Hollywood, Bollywood & Bangla Movies">
    <meta name="description" content="Watch and download the latest Hollywood, Bollywood, and Bangla movies daily. Get updates on new releases and full movie details.">
    <style>
        /* ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ CSS ‡¶ï‡ßã‡¶° ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá (‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡¶®‡¶ø) */
        body { font-family: 'Inter', Arial, sans-serif; margin: 0; padding: 0; background: #121212; color: #f5f5f5; }
        header { background-color: #e50914; padding: 1rem; text-align: center; border-bottom-left-radius: 8px; border-bottom-right-radius: 8px; }
        h1 { margin: 0; font-size: 2rem; color: #fff; }
        nav { background: #1f1f1f; display: flex; justify-content: center; gap: 1.5rem; padding: 1rem 0; border-radius: 8px; margin: 1rem; flex-wrap: wrap; } /* Added flex-wrap */
        nav a { color: #fff; text-decoration: none; font-weight: bold; cursor: pointer; padding: 0.5rem 1rem; border-radius: 4px; transition: background-color 0.3s ease, color 0.3s ease; }
        nav a:hover { background-color: #e50914; color: #fff; }
        .container { padding: 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; justify-content: center; }
        .movie { background: #1f1f1f; border-radius: 12px; padding: 1.5rem; text-align: center; position: relative; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); transition: transform 0.2s ease-in-out; }
        .movie:hover { transform: translateY(-5px); }
        .movie img { width: 100%; max-width: 250px; height: 375px; /* Fixed height */ border-radius: 8px; margin-bottom: 1rem; object-fit: cover; } /* Added fixed height */
        .movie h2 { margin: 0.5rem 0; font-size: 1.3rem; color: #e50914; min-height: 3.9rem; /* Ensure consistent height */}
        .download-btn { margin-top: 1rem; display: inline-block; background: #e50914; color: white; padding: 0.8rem 1.5rem; border: none; border-radius: 6px; font-size: 1rem; text-decoration: none; font-weight: bold; transition: background 0.3s ease, transform 0.2s ease; }
        .download-btn:hover { background: #ff222d; transform: translateY(-2px); }
        .view-details-btn { margin-top: 0.8rem; background: transparent; border: 2px solid #e50914; color: #e50914; padding: 0.6rem 1.2rem; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 0.95rem; transition: background 0.3s ease, color 0.3s ease; }
        .view-details-btn:hover { background: #e50914; color: white; }
        .pagination { text-align: center; margin: 2rem 0; grid-column: 1 / -1; }
        .pagination button { background: #e50914; color: white; padding: 0.8rem 2rem; border: none; border-radius: 6px; font-size: 1.1rem; cursor: pointer; font-weight: bold; transition: background 0.3s ease, transform 0.2s ease; }
        .pagination button:hover { background: #ff222d; transform: translateY(-2px); }
        .movie-detail-view { background: #1f1f1f; border-radius: 12px; padding: 2rem; margin: 2rem auto; max-width: 800px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); text-align: left; }
        .movie-detail-view img { display: block; margin: 0 auto 1.5rem auto; max-width: 350px; border-radius: 10px; }
        .movie-detail-view h2 { text-align: center; font-size: 2rem; margin-bottom: 1rem; color: #e50914; } /* Added color */
        .movie-detail-view p { line-height: 1.6; margin-bottom: 1rem; }
        .movie-detail-view .download-btn { display: block; text-align: center; margin: 1.5rem auto 1rem auto; max-width: 200px; }
        .movie-detail-view .view-details-btn { display: block; margin: 1rem auto 0 auto; max-width: 200px; text-align: center; }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; background: #000; margin-bottom: 1.5rem; border-radius: 8px; } /* Added radius */
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        #ad-script-container { margin: 1.5rem auto; text-align: center; /* Add styling as needed */ }
        @media (max-width: 768px) {
            .container { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); padding: 1rem; }
            .movie { padding: 1rem; }
            .movie img { height: 300px; }
            .movie h2 { font-size: 1.1rem; min-height: 3.3rem; }
            nav { gap: 0.5rem; margin: 0.5rem; padding: 0.8rem; } /* Adjusted gap/padding */
            .movie-detail-view { padding: 1.5rem; margin: 1rem; }
            .movie-detail-view img { max-width: 80%; }
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <h1>üé¨ Daily Movie Updates</h1>
    </header>
    <nav>
        <a id="nav-all">All</a>
        <a id="nav-hollywood">Hollywood</a>
        <a id="nav-bollywood">Bollywood</a>
        <a id="nav-bangla">Bangla</a>
    </nav>
    <div class="container" id="movie-container"></div>
    <div class="pagination">
        <button id="next-btn">Next</button>
    </div>

    <div id="ad-script-container"></div> 

    <script src="movies.js"></script> <script>
        document.addEventListener('DOMContentLoaded', () => { // Wait for DOM to load

            let currentIndex = 0;
            const limit = 6;
            let filteredMovies = []; // Initialize as empty, will be set by filterMovies
            const container = document.getElementById("movie-container");
            const nextBtn = document.getElementById("next-btn");
            // *** ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ GitHub Pages repository ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡ßü‡ßá "/MovieBD99" ‡¶Ö‡¶Ç‡¶∂‡¶ü‡¶ø ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ***
            const gitHubPagesBasePath = "/MovieBD99"; 
            const isCanvasPreview = window.location.protocol === 'blob:';
            const AD_INTERVAL = 20 * 60 * 1000; // 20 minutes
            let adScriptContainer = document.getElementById('ad-script-container');

            function generateSlug(title) {
                return title.toLowerCase()
                    .replace(/[^\w\s-]/g, '') // Remove non-word chars except space/hyphen
                    .replace(/[\s_-]+/g, '-') // Replace spaces/underscores with single hyphen
                    .replace(/^-+|-+$/g, ''); // Trim hyphens
            }

            function displayMovies() {
                const nextBatch = filteredMovies.slice(currentIndex, currentIndex + limit);
                nextBatch.forEach((movie) => {
                    const div = document.createElement("div");
                    div.className = "movie";
                    div.innerHTML = `
                        <img src="${movie.img}" alt="${movie.title}" onerror="this.onerror=null;this.src='https://placehold.co/250x375/333333/FFFFFF?text=Image+Not+Found';" />
                        <h2>${movie.title}</h2>
                        <button class="view-details-btn" data-title="${encodeURIComponent(movie.title)}">View Details</button>
                    `; // Used data-title for safer access
                    container.appendChild(div);
                });

                // Add event listeners AFTER appending
                container.querySelectorAll('.view-details-btn').forEach(btn => {
                    btn.onclick = (event) => { // Use onclick or addEventListener
                       const title = decodeURIComponent(event.target.getAttribute('data-title'));
                       const movie = movies.find(m => m.title === title);
                       if(movie) {
                            const urlSlug = generateSlug(movie.title);
                            const newPath = gitHubPagesBasePath + "/" + urlSlug;
                            if (!isCanvasPreview) {
                                history.pushState({ movieTitle: movie.title }, movie.title, newPath);
                            }
                            showMovieDetails(movie.title);
                       }
                    };
                });

                currentIndex += limit;
                nextBtn.style.display = currentIndex >= filteredMovies.length ? "none" : "inline-block";
            }
            
            function updateNavLinks() {
                const navLinks = [
                    { id: 'nav-all', category: 'All' },
                    { id: 'nav-hollywood', category: 'Hollywood' },
                    { id: 'nav-bollywood', category: 'Bollywood' },
                    { id: 'nav-bangla', category: 'Bangla' }
                ];
                navLinks.forEach(link => {
                    document.getElementById(link.id).addEventListener('click', (e) => {
                        e.preventDefault();
                        const newPath = gitHubPagesBasePath + "/";
                        if (!isCanvasPreview) {
                            history.pushState({ filterCategory: link.category }, `${link.category} Movies`, newPath);
                        }
                        filterMovies(link.category);
                    });
                });
            }

            function filterMovies(category) {
                container.innerHTML = '';
                currentIndex = 0;
                document.title = `Daily Movie Updates - ${category}`;
                // *** Ensure 'movies' exists before filtering ***
                if (typeof movies === 'undefined' || !movies) {
                    console.error("movies.js data not loaded!");
                    container.innerHTML = "<p>Error: Movie data could not be loaded.</p>";
                    nextBtn.style.display = 'none';
                    return;
                }
                filteredMovies = category === "All" ? [...movies] : movies.filter(movie => movie.category === category);
                displayMovies();
                nextBtn.style.display = currentIndex < filteredMovies.length ? "inline-block" : "none";
            }

            function showMovieDetails(title) {
                container.innerHTML = '';
                nextBtn.style.display = 'none';
                
                // *** Ensure 'movies' exists before finding ***
                if (typeof movies === 'undefined' || !movies) {
                     console.error("movies.js data not loaded!");
                     showMovieNotFoundError();
                     return;
                }

                const movie = movies.find(m => m.title === title);
                if (!movie) {
                    showMovieNotFoundError();
                    return;
                }

                document.title = `${movie.title} - Details`;
                const div = document.createElement("div");
                div.className = "movie-detail-view";

                let movieDetailHtml = `
                    <img src="${movie.img}" alt="${movie.title}" onerror="this.onerror=null;this.src='https://placehold.co/350x500/333333/FFFFFF?text=Image+Not+Found';" />
                    <h2>${movie.title}</h2>
                    <p><strong>Release Date:</strong> ${movie.year}</p>
                    <p>${movie.desc}</p>
                `;

                if (movie.videoUrl) {
                    movieDetailHtml += `
                        <div class="video-container">
                            <iframe src="${movie.videoUrl}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    `;
                }

                movieDetailHtml += `
                    <a href="${movie.download}" class="download-btn" download>‚¨áÔ∏è Download</a>
                `;

                div.innerHTML = movieDetailHtml;

                const backBtn = document.createElement("button");
                backBtn.textContent = "Back to Movie List";
                backBtn.className = "view-details-btn";
                backBtn.addEventListener("click", () => {
                    const newPath = gitHubPagesBasePath + "/";
                    if (!isCanvasPreview) {
                        history.pushState({ filterCategory: 'All' }, "Movie List", newPath);
                    }
                    filterMovies('All');
                });
                div.appendChild(backBtn);
                container.appendChild(div);
            }

            function showMovieNotFoundError() {
                 container.innerHTML = `
                    <div class="movie-detail-view" style="text-align: center;">
                        <p style="font-size: 1.2rem; margin-bottom: 1.5rem;">Movie not found or invalid URL.</p>
                        <button id="backFromNotFound" class="view-details-btn">Back to Movie List</button>
                    </div>
                `;
                document.title = "Movie Not Found";
                document.getElementById("backFromNotFound").addEventListener("click", () => {
                    const newPath = gitHubPagesBasePath + "/";
                    if (!isCanvasPreview) {
                        history.pushState({ filterCategory: 'All' }, "Movie List", newPath);
                    }
                    filterMovies('All');
                });
            }

            window.addEventListener("popstate", (event) => {
                if (event.state?.movieTitle) {
                    showMovieDetails(event.state.movieTitle);
                } else if (event.state?.filterCategory) {
                    filterMovies(event.state.filterCategory);
                } else {
                    handleRouteChange(); // Handle direct navigation/reloads
                }
            });

            function handleRouteChange() {
                const urlParams = new URLSearchParams(window.location.search);
                const redirectedPath = urlParams.get('p');
                let currentPath;

                if (redirectedPath) {
                    // Came from 404.html redirect
                    currentPath = decodeURIComponent(redirectedPath);
                    // Update URL without the ?p= part
                    if (!isCanvasPreview) {
                         history.replaceState(history.state, '', currentPath);
                    }
                } else {
                    currentPath = window.location.pathname;
                }

                let slug = currentPath.startsWith(gitHubPagesBasePath) ? currentPath.substring(gitHubPagesBasePath.length) : currentPath;
                if (slug.startsWith('/')) slug = slug.substring(1);

                console.log("Routing based on slug:", slug); // Debugging line

                if (slug && slug !== '') {
                    const movie = movies.find(m => generateSlug(m.title) === slug);
                    if (movie) {
                        showMovieDetails(movie.title);
                    } else {
                        // Check if it's a known category (case-insensitive)
                        const categoryMatch = ['All', 'Hollywood', 'Bollywood', 'Bangla'].find(c => c.toLowerCase() === slug.toLowerCase());
                        if(categoryMatch) {
                           filterMovies(categoryMatch);
                        } else {
                           console.warn("Unknown slug:", slug, "- showing 'All'");
                           showMovieNotFoundError(); // Or filterMovies('All');
                        }
                    }
                } else {
                    filterMovies('All');
                }
            }
            
            // --- Ad Logic ---
            function canShowAdNow() {
                const lastClickTime = localStorage.getItem('lastAdClickTime');
                if (!lastClickTime) return true; // Never clicked, show
                return (Date.now() - parseInt(lastClickTime)) >= AD_INTERVAL;
            }

            function attemptToShowAd() {
                if (canShowAdNow()) {
                    console.log("Loading ad...");
                    adScriptContainer.innerHTML = ''; // Clear previous

                    const script = document.createElement('script');
                    script.type = 'text/javascript';
                    script.src = '//surprisinglystaunchdemocratic.com/d1/26/cc/d126cc889115577f9acfa2f4b91c68e7.js';
                    script.onerror = () => { 
                        console.error("Ad script failed to load."); 
                        adScriptContainer.innerHTML = ''; // Clear on error too
                    };
                    script.onload = () => { 
                        console.log("Ad script loaded."); 
                        // *** ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶°‡¶ø‡¶ü‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶ï‡¶†‡¶ø‡¶® ***
                        // ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶™‡ßÅ‡¶∞‡ßã ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶á‡¶®‡¶æ‡¶∞‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶≤‡¶ø‡¶∏‡ßá‡¶®‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø,
                        // ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶è‡¶ü‡¶ø ‡ßß‡ß¶‡ß¶% ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø ‡¶®‡ßü‡•§
                        adScriptContainer.onclick = () => {
                             console.log("Ad container clicked - Assuming ad interaction!");
                             localStorage.setItem('lastAdClickTime', Date.now());
                             adScriptContainer.innerHTML = ''; // ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶≤‡ßÅ‡¶ï‡¶ø‡ßü‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®
                             // ‡ß®‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶™‡¶∞ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®
                             setTimeout(attemptToShowAd, AD_INTERVAL); 
                        };
                    };
                    adScriptContainer.appendChild(script);
                } else {
                    console.log("Ad suppressed (waiting 20 mins post-click).");
                    // Check again later
                    setTimeout(attemptToShowAd, AD_INTERVAL - (Date.now() - parseInt(localStorage.getItem('lastAdClickTime'))));
                }
            }
            
            function init() {
                updateNavLinks();
                handleRouteChange(); // Handle initial load / reload
                nextBtn.addEventListener("click", displayMovies);
                attemptToShowAd(); // Show ad on initial load (if possible)
                // Periodically check if we can show ad (e.g., every 5 mins)
                // This interval is a fallback in case the setTimeout chain breaks.
                setInterval(attemptToShowAd, 5 * 60 * 1000); 
            }

            // Ensure movies is loaded, then init. A small delay can help sometimes.
            if (typeof movies !== 'undefined') {
                init();
            } else {
                console.error("movies.js seems not loaded yet. Waiting...");
                setTimeout(() => {
                    if (typeof movies !== 'undefined') {
                        init();
                    } else {
                       document.getElementById('movie-container').innerHTML = "<h1>Error: Could not load movie data. Please try again later.</h1>";
                    }
                }, 500); // Wait 0.5 sec and try again.
            }

        }); // End of DOMContentLoaded
    </script>
    </body>
</html>
